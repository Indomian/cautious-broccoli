!function(){function t(t,s,i){return s in t?Object.defineProperty(t,s,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[s]=i,t}class s{render(){}constructor(t){this.context=t}}class i extends s{render(){this.context.beginPath(),this.context.arc(this.x,this.y,this.r,0,2*Math.PI),this.context.fillStyle=this.color,this.context.fill()}constructor(s,i,e,n,r){super(s),t(this,"x",0),t(this,"y",0),t(this,"r",0),t(this,"color","#00ff00"),this.x=i,this.y=e,this.r=n,r&&(this.color=r)}}class e{add(t){return this.x+=t.x,this.y+=t.y,this}sub(t){return this.x-=t.x,this.y-=t.y,this}flipY(){return this.y=-this.y,this}sum(t){return new e(this.x+t.x,this.y+t.y)}diff(t){return new e(this.x-t.x,this.y-t.y)}mul(t){return new e(this.x*t,this.y*t)}copy(){return new e(this.x,this.y)}get length(){return Math.sqrt(this.x*this.x+this.y*this.y)}get normalized(){const t=this.length;return new e(this.x/t,this.y/t)}static Zero(){return new e(0,0)}constructor(s,i){t(this,"x",0),t(this,"y",0),this.x=s,this.y=i}}class n{static diff(t,s){return new e(t.x-s.x,t.y-s.y)}static mul(t,s){return new e(t.x*s,t.y*s)}}class r{update(t){const s=this.currentPosition.diff(this.previousPosition);this.previousPosition=this.currentPosition.copy(),this.currentPosition.add(s.add(this.acc.mul(t*t))),this.acc=e.Zero()}accelerate(t){this.acc.add(t)}collide(t){const s=n.diff(this.currentPosition,t.currentPosition),i=s.length,e=this.radius+t.radius;if(i<this.radius+t.radius){const r=s.normalized,h=e-i;this.currentPosition.add(n.mul(r,this.radius/e*h*this.bounceValue)),t.currentPosition.sub(n.mul(r,t.radius/e*h*t.bounceValue))}}get velocity(){return this.currentPosition.diff(this.previousPosition)}set velocity(t){this.previousPosition=n.diff(this.currentPosition,t)}constructor(s){t(this,"previousPosition",e.Zero()),t(this,"currentPosition",e.Zero()),t(this,"acc",e.Zero()),t(this,"radius",10),t(this,"bounceValue",1),this.previousPosition=s,this.currentPosition=s}}class h{applyConstrain(t){}constructor(){}}class o extends h{applyConstrain(t){super.applyConstrain(t);const s=t.currentPosition.diff(this.center),i=s.length,e=t.radius;if(i>this.radius-e){const i=s.normalized;t.currentPosition=this.center.sum(i.mul(this.radius-e*t.bounceValue))}}constructor(s,i){super(),t(this,"center",e.Zero()),t(this,"radius",0),this.center=s,this.radius=i}}class a{getNextObject(t){return null}constructor(){}}class c{constructor(s,i){t(this,"timeout",void 0),t(this,"object",void 0),this.timeout=s,this.object=i}}class u extends a{getNextObject(t){if(!(this.total>this.limit)&&(this.lastCreateTime+=t,this.lastCreateTime>this.delay)){const t=this.create();return this.lastCreateTime=0,this.total++,t}}constructor(t,s,i){super(),this.limit=t,this.total=0,this.delay=s,this.create=i,this.lastCreateTime=0}}new c(1,new r(new e(10,10))),new c(2,new r(new e(10,10))),new c(3,new r(new e(10,10)));class l{configure(){this.context.font="10px serif",this.gravity=new e(0,100),this.constrains=new o(new e(this.canvas.width/2,this.canvas.height/2),this.canvas.height/2),this.items.push(new i(this.context,this.canvas.width/2,this.canvas.height/2,this.canvas.height/2,"#000000")),this.generator=new u(200,.2,(()=>{const t=new r(new e(this.canvas.width/2,this.canvas.height/2));return t.velocity=new e(5,-1),t.radius=20*Math.random()+5,t}))}update(t){const s=this.generator.getNextObject(t);s&&this.objects.push(s),this.applyGravity(),this.applyConstrains(),this.processCollisions(),this.objects.forEach((s=>s.update(t)))}applyGravity(){this.objects.forEach((t=>t.accelerate(this.gravity)))}applyConstrains(){this.objects.forEach((t=>this.constrains.applyConstrain(t)))}processCollisions(){this.objects.forEach((t=>{this.objects.forEach((s=>{t!==s&&t.collide(s)}))}))}renderItems(){this.items.forEach((t=>t.render())),this.objects.forEach((t=>{new i(this.context,t.currentPosition.x,t.currentPosition.y,t.radius).render()}))}printText(t,s,i){this.context.fillStyle="#000000",this.context.fillText(t,s,i)}printFPS(){this.printText(`${Math.round(this.step)} ms / ${Math.round(1e3/this.step)} FPS`,0,10)}clear(){this.context.fillStyle="#ffffff",this.context.fillRect(0,0,this.canvas.width,this.canvas.height)}start(){self.requestAnimationFrame(this.nextFrame)}constructor(s){t(this,"objects",[]),t(this,"constrains",null),t(this,"nextFrame",(t=>{this.step=t-this.timeRenderEnd,this.step<0&&(this.step=0),this.update(this.step/1e3),this.clear(),this.renderItems(),this.printFPS(),this.timeRenderEnd=t,self.requestAnimationFrame(this.nextFrame)})),this.canvas=s,this.context=this.canvas.getContext("2d"),this.timeRenderStart=Date.now(),this.timeRenderEnd=Date.now(),this.step=0,this.gravity=e.Zero(),this.items=[],this.objects=[],this.generator=null,this.configure()}}onmessage=function(t){console.log(t);new l(t.data.canvas).start()}}();
//# sourceMappingURL=main.b8306ff7.js.map
